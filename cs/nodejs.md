# Node.js

## Node.js는 싱글 스레드인가 멀티 스레드인가?

<details>
  <summary>Node.js 동작 원리</summary> 
Node.js는 확장성 있는 네트워크 애플리케이션 개발에 사용되는 SW 플랫폼이다. 기본적으로 `Non-blocking I/O`와 `단일 스레드 이벤트 루프 기반의 비동기Asynchronous 방식`를 통한 높은 처리 성능을 가지고 있다.

blocking은 하나의 스레드가 하나의 요청만을 수행하여 다른 요청을 함께 수행할 수 없다. 이전의 요청을 블로킹하고 있기 때문이다. 멀티스레드에서는 요청 수 만큼 스레드를 매칭하여 수행하는데 효율적인 측면에서 단점이 크다. Node.js는 `싱글스레드 논블로킹 모델`로 하나의 스레드에서 동작하지만 비동기 I/O 작업으로 `서로 요청을 블로킹하지 않는다`.

하나의 스레드가 request를 받으면 다음 처리에 요청을 보내고 다른 작업을 처리하다가 먼저 요청한 작업이 끝나면 이벤트를 받아서 응답을 보낸다. 동시 request가 오더라도 처리가 완료될때까지 기다리지 않아도 되기 때문에 서버 부하가 적다.

하지만 콜백을 통해 여러 비동기 함수를 실행하면 이벤트 루프에 부담을 주어 성능이 줄어든다. 

따라서 Networking 관련 작업 등 메인 스레드가 작업하는 기본 작업 외 `블로킹 작업들`인 `파일 시스템`에 접근하거나 해싱 등의 작업으로 추가 스레드가 필요하면 새로운 스레드를 생성하는 `멀티 스레드Multi-thread 프로세스`이기도 하다. 노드에서 멀티 스레딩이 가능한 것은 JS 코드의 일정 부분이 C++에 기반하기 때문이다. 미리 생성되어 비어있는 `스레드 풀Thread Pool`에서 작동한다. 기본값은 4개이다.

  </details>

> 싱글 스레드인가 멀티 스레드인가?
>
> Node.js는 기본적으로 싱글스레드 논블로킹 모델이고 메인 스레드는 비동기적으로 서로 요청을 블로킹하지 않는 이벤트 루프 기반의 싱글 스레드에서 동작하지만, 블로킹 작업이 필요한 파일시스템 접근 등의 작업에 한해 스레드 풀에서 동작하는 멀티 스레드 모델이다.